package app;

import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.util.function.Function;
import static org.junit.jupiter.api.Assertions.assertEquals;

public class CombineOperationTest {

  private Function<String, String> LowerCaseStupidRemoverUppercase() {
    Function<String, String> lowerCase = LowerCaseOperation::convert;
    Function<String, String> stupidRemover = lowerCase.andThen(StupidRemoverOperation::convert);
    //Feedback: the test should not be doing this. The test (user) should present the Writer with converters
    return stupidRemover.andThen(UpperCaseOperation::convert);
  }

  private Function<String, String> UpperCaseStupidRemoverLowerCase() {
    Function<String, String> upperCase = UpperCaseOperation::convert;
    Function<String, String> stupidRemover = upperCase.andThen(StupidRemoverOperation::convert);
    return stupidRemover.andThen(LowerCaseOperation::convert);
  }

  @Test
  void StringWriterWriteThisisniceandCallLowerStupidUpper() throws IOException {
    Function<String, String> combinedFunctions = LowerCaseStupidRemoverUppercase();

    StringWriter stringWriter = new StringWriter(combinedFunctions);

    stringWriter.write("This is nice");
    stringWriter.close();

    assertEquals("THIS IS NICE", stringWriter.getContents());
  }

  @Test
  void StringWriterwriteThisisStupidandCallLowerStupidUpper() throws IOException {
    Function<String, String> combinedFunctions = LowerCaseStupidRemoverUppercase();

    StringWriter stringWriter = new StringWriter(combinedFunctions);

    stringWriter.write("This is STUPID");
    stringWriter.close();

    assertEquals("THIS IS S*****", stringWriter.getContents());
  }

  @Test
  void StringWriterWriteThisisniceandCallUpperStupidLower() throws IOException {
    Function<String, String> combinedFunctions = UpperCaseStupidRemoverLowerCase();

    StringWriter stringWriter = new StringWriter(combinedFunctions);

    stringWriter.write("This is nice");
    stringWriter.close();

    assertEquals("this is nice", stringWriter.getContents());
  }

  @Test
  void StringWriterwriteThisisStupidandCallUpperStupidLower() throws IOException {
    Function<String, String> combinedFunctions = UpperCaseStupidRemoverLowerCase();

    StringWriter stringWriter = new StringWriter(combinedFunctions);

    stringWriter.write("This is STUPID");
    stringWriter.close();

    assertEquals("this is stupid", stringWriter.getContents());
  }
}
